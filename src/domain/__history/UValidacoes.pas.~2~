unit UValidacoes;

interface

uses System.SysUtils;

type
  TValidacoes = class
  public
    class procedure AssegurarPositivo(const Valor: Double; const NomeCampo: string);
    class function TaxaFromStr(const S: string): Double; // aceita 0,13 ou 13%
  end;

implementation

class procedure TValidacoes.AssegurarPositivo(const Valor: Double; const NomeCampo: string);
begin
  if Valor <= 0 then
    raise Exception.CreateFmt('%s deve ser maior que zero.', [NomeCampo]);
end;

class function TValidacoes.TaxaFromStr(const S: string): Double;
var T: string; V: Double;
begin
  T := Trim(S).Replace('%','',[]).Replace(',','.',[]);
  V := StrToFloat(T);
  if V > 1 then
    V := V/100.0;
  if (V < 0) or (V > 1) then
    raise Exception.Create('Taxa fora do intervalo (0..1).');
  Result := V;
end;

end.
